# 头文件

头文件的作用就是被其他的.cpp包含进去的。它们本身并不参与编译，但实际上，它们的内容却在多个.cpp文件中得到了 编译。通过“定义只能有一次”的规则，我们很容易可以得出，**头文件中应该只放变量和函数的声明，而不能放它们的定义**。因为一个头文件的内容实际上是会被引入到多个不同的.cpp文件中的，并且它们都会被编译。放声明当然没事，如果放了定义，那么也就相当于在多个文件中出现了对于一个符号（变量或函数）的定 义，纵然这些定义都是相同的，但对于编译器来说，这样做不合法。

所以，应该记住的一点就是，.h头文件中，只能存在变量或者函数的声明， 而不要放定义。即，只能在头文件中写形如：extern int a;和void f();的句子。这些才是声明。如果写上int a;或者void f() {}这样的句子，那么一旦这个头文件被两个或两个以上的.cpp文件包含的话，编译器会立马报错。

**但是，这个规则是有三个例外的。**

- 一，**头文件中可以写const对象的定义。因为全局的const对象默 认是没有extern的声明的，所以它只在当前文件中有效**。把这样的对象写进头文件中，即使它被包含到其他多个.cpp文件中，这个对象也都只在包含它的 那个文件中有效，对其他文件来说是不可见的，所以便不会导致多重定义。同时，因为这些.cpp文件中的该对象都是从一个头文件中包含进去的，这样也就保证 了这些.cpp文件中的这个const对象的值是相同的，可谓一举两得。**同理，static对象的定义也可以放进头文件。**

- 二，**头文件中可 以写内联函数（inline）的定义**。因为inline函数是需要编译器在遇到它的地方根据它的定义把它内联展开的，而并非是普通函数那样可以先声明再链 接的（**内联函数不会链接**），所以编译器就需要在编译时看到内联函数的完整定义才行。如果内联函数像普通函数一样只能定义一次的话，这事儿就难办了。因为在 一个文件中还好，我可以把内联函数的定义写在最开始，这样可以保证后面使用的时候都可以见到定义；但是，如果我在其他的文件中还使用到了这个函数那怎么办 呢？这几乎没什么太好的解决办法，因此C++规定，内联函数可以在程序中定义多次，只要内联函数在一个.cpp文件中只出现一次，并且在所有的.cpp文 件中，这个内联函数的定义是一样的，就能通过编译。那么显然，把内联函数的定义放进一个头文件中是非常明智的做法。

- 三，头文件中可以写类（class）的定义。因为在程序中创建一个类的对象时，编译器只有在这个类的定义完全可见的情况下，才能知道这个类的对象应该如何布局，所以，关于类的 定义的要求，跟内联函数是基本一样的。所以把类的定义放进头文件，在使用到这个类的.cpp文件中去包含这个头文件，是一个很好的做法。在这里，值得一提 的是，**类的定义中包含着数据成员和函数成员。数据成员是要等到具体的对象被创建时才会被定义（分配空间），但函数成员却是需要在一开始就被定义的，这也就 是我们通常所说的类的实现。一般，我们的做法是，把类的定义放在头文件中，而把函数成员的实现代码放在一个.cpp文件中。这是可以的，也是很好的办法**。 不过，还有另一种办法。**那就是直接把函数成员的实现代码也写进类定义里面。在C++的类中，如果函数成员在类的定义体中被定义，那么编译器会视这个函数为 内联的。因此，把函数成员的定义写进类定义体，一起放进头文件中，是合法的。
  注意一下，如果把函数成员的定义写在类定义的头文件中，而没有写进类定义中， 这是不合法的，因为这个函数成员此时就不是内联的了。一旦头文件被两个或两个以上的.cpp文件包含，这个函数成员就被重定义了。**

# 库文件



编译时如何根据头文件找到对应的库文件呢并进行连接呢？
头文件中说明了用到哪些标准库函数，但是编译时如何找到对应的库文件呢？
比如我们用到输出输入，就是在头文件中
\#include <iostream>
即包含这个文件，但是这个文件中只有函数原型呀？具体的函数实现是放在库文件中的。（一般是*.lib吧），但是我不明白，编译器在编译时，是如何找到对应的库文件的呢？这么多库文件，编译器总不可能一个一个去找吧，但是程序的源代码中确实没有提定如何搜索库文件的信息呀？
而且库文件的名字，与头文件的名字也应有规律的对应关系呀？
编译器是如何找到对应的库文件，并进行连接的呢？



编译时不需要找到对应的库文件，**链接时才需要**。链接时它也不找，而是采取如下办法：
1.**把所有需要的库中的符号都载入内存（这里需要的库是工程里设置好的，而不是根据头文件变化而变化的）**

2.**链接时如果需要一个函数，链接程序会到步骤1中的符号表中找，并进行定位**。
所以无论在哪个库文件中，只要你在工程中指定它为需要的库，则链接程序都会载入它的符号到符号表。要找到需要的函数，不需要知道它在哪个库文件中，只要符号表有即可。

